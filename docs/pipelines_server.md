# Server Pipelines

Our lab has access to virtual servers through the UW Biotechnology Center, attached to sequencing data generated by the center. We also have access to powerful computing resources and support through the Center for High-Throughput Computing (CHTC). Our core bioinformatics and image processing pipelines will be deployed through CHTC servers.

In general, pipelines will be run in three steps:

  - **Input:** input files will be transferred to the CHTC server (staging)
  - **Pipeline:** files will be processed using established pipelines
  - **Output:** desired outputs will be transferred from the CHTC server to lab storage

All pipelines will be maintained on [GitHub](http://www.github.com) and associated with [Docker](http://www.docker.com) environments to ensure reproducibility. Many of our pipelines will use [Nextflow](https://www.nextflow.io/).

## 1. Center for High-throughput Computing (CHTC)

Consult official [CHTC](http://chtc.cs.wisc.edu/) and [HTCondor](https://research.cs.wisc.edu/htcondor/) documentation before getting started. Register for an account using this [form](http://chtc.cs.wisc.edu/form.shtml).

### CHTC Hardware and File System

**Compute nodes:** The CHTC has an extensive set of compute nodes that can be accessed for free. To establish priority access for certain pipelines, our lab has secured a dedicated node that can be accessed using a designated flag.

  - Typical nodes: 20 cores, 128 GB RAM
  - [High-memory nodes](http://chtc.cs.wisc.edu/high-memory-jobs.shtml): e.g., 80 cores, 4 TB RAM
  - Dedicated lab node: 40 cores, 512 GB RAM, 3.5 TB HD

**Submit nodes:** Jobs on the CHTC are deployed from submit nodes. You can `ssh` into your assigned submit node to run and monitor jobs using your UW net-id and password.

  	ssh [net-id]@submit3.chtc.wisc.edu

**File System:** The CHTC does not make use of a shared file system, but you can request the storage you need for any given job.

```
/
  ├── home/net-id/              [initial quota: 20 GB, submit script dir]
  └── staging/net-id/           [initial quota: 200 GB | 1000 files]
      └── data/                   [data input dir]
      └── output/                 [job output dir]
```

### Deploying Pipelines

Transfer folder containing job input files to staging directory `data` folder. You can run transfer commands from lab file server or BRC server (sequencing data).

`scp [dir] [net-id]@transfer.chtc.wisc.edu:/staging/[net-id]/data/`

**Creating and submitting jobs**:
